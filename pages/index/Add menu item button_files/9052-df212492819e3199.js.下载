try{let e="undefined"!=typeof window?window:"undefined"!=typeof global?global:"undefined"!=typeof globalThis?globalThis:"undefined"!=typeof self?self:{},t=(new e.Error).stack;t&&(e._sentryDebugIds=e._sentryDebugIds||{},e._sentryDebugIds[t]="080b9a2c-cbbd-4caa-9613-1e4f5112c4ed",e._sentryDebugIdIdentifier="sentry-dbid-080b9a2c-cbbd-4caa-9613-1e4f5112c4ed")}catch(e){}"use strict";(self.webpackChunk_N_E=self.webpackChunk_N_E||[]).push([[5054,9052],{3743:(e,t,r)=>{r.d(t,{Ah:()=>o,Bs:()=>a,NJ:()=>i,VH:()=>n,Xs:()=>s,u5:()=>l});let n=e=>{let{account:t,isClaudeDot:r}=e;return r?!1===t.settings.has_finished_claudeai_onboarding:!t.full_name||!t.display_name},a=(e,t)=>t&&!e.is_verified,i=(e,t)=>!!function(e,t){for(let r of e.invites)if(r.organization.capabilities&&r.organization.capabilities.includes(t))return r}(e,t?"raven":"api"),o=(e,t)=>!t&&0===e.invites.length&&0===e.memberships.filter(e=>e.organization.capabilities.includes("api")).length,l=function(e,t){let r=arguments.length>2&&void 0!==arguments[2]&&arguments[2];return r&&t&&!e.age_is_verified},s=function(e,t){let r=arguments.length>2&&void 0!==arguments[2]&&arguments[2];return n({account:e,isClaudeDot:t})||a(e,t)||i(e,t)||o(e,t)||l(e,t,r)}},10665:(e,t,r)=>{r.d(t,{r:()=>y,v:()=>_});var n=r(94295),a=r(19736),i=r(34003),o=r(74813),l=r(64328),s=r(68067),u=r(95617),c=r(7620),d=r(45538),f=r(88775),g=r(48778);let v=e=>{let{value:t}=(0,s.fS)("claudeai_paprika_sticky"),{value:r}=(0,s.fS)("claude_ai_sticky_project_settings"),n=["enabled_web_search","enabled_bananagrams","enabled_sourdough","enabled_foccacia","enabled_mcp_tools"];return(t||e&&r)&&n.push("paprika_mode"),e&&r&&n.push("compass_mode"),n},_=e=>{let t=(0,f.jw)(),{pendingConversationSettings:r}=(0,f.Fj)(),{account:n}=(0,l.YL)(),a=(0,f.QN)(),{data:o}=(0,d.xQ)(a),{value:u}=(0,s.fS)("claude_ai_sticky_project_settings"),c=v(!!a);if((0,i.u9)(),t){var g;return null==(g=t.conversationSettings)?void 0:g[e]}return c.includes(e)?a&&u&&o?o[e]:null==n?void 0:n.settings[e]:null==r?void 0:r[e]},y=e=>{let t=(0,f.jw)(),{setPendingConversationSettings:r}=(0,f.Fj)(),i=(0,f.QN)(),{account:_}=(0,l.YL)(),y=v(!!i),{isInBeam:p,beamConversationSettings:b,setBeamConversationSettings:m}=(0,g.d)(),{track:S}=(0,o.st)(),{mutate:h}=(0,n.Jy)(),{mutate:w}=(0,a.HF)(null==t?void 0:t.id),{data:E}=(0,d.xQ)(i),{mutate:k}=(0,d.mu)(i),{value:I}=(0,s.fS)("claude_ai_sticky_project_settings"),C=(0,c.useCallback)(n=>{if(!_)return;t?w({settings:{...n}}):p&&m&&m({...b,...n});let a={},o=!1;Object.keys(n).forEach(i=>{let l=n[i];y.includes(i)?(Object.assign(a,{[i]:l}),o=!0):u.W$.includes(i)&&!t&&r({[i]:l}),S({event_key:"claudeai.conversation.setting.toggled",conversation_uuid:(null==t?void 0:t.id)||null,setting:i,value:l,source:null==e?void 0:e.source})}),o&&(i&&I?k({...E,...a}):h({..._.settings,...a}))},[_,t,w,p,m,b,y,h,S,r,E,i,k,I,null==e?void 0:e.source]);return{toggleConversationSetting:(0,c.useCallback)((e,t)=>{C({[e]:t})},[C]),batchToggleConversationSettings:C}}},18088:(e,t,r)=>{r.d(t,{Vc:()=>o,Wz:()=>i});var n=r(80039),a=r(61903);function i(e,t){return(0,n.F)({key:"SSS-".concat(e),defaultValue:t,serialize:JSON.stringify,deserialize:e=>void 0===e?t:JSON.parse(e)})}function o(e,t){let r=!(arguments.length>2)||void 0===arguments[2]||arguments[2];return(0,a.Q)(e,t,r)}},45054:(e,t,r)=>{r.d(t,{ErrorSegmentConnector:()=>j,ErrorStatsigConnector:()=>T,ErrorsProvider:()=>I,i:()=>M,Y:()=>C});var n=r(54568),a=r(3743),i=r(16178),o=r(68067),l=r(69287),s=r(22300),u=r.n(s),c=r(61483),d=r.n(c),f=r(83487),g=r.n(f),v=r(27541),_=r(7620),y=r(24407),p=r(74813),b=r(64328);function m(e,t){let r=[];for(let n of e){if(null==n)continue;let e=S(n,t+1);""!==e&&r.push(e)}return r.length>0?r.join(" "):""}function S(e){let t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:0;return t>5?"":e instanceof Error?e.message:"string"==typeof e||"number"==typeof e||"boolean"==typeof e?String(e):_.isValidElement(e)?function e(t,r){var n;let a=t.props;return"object"==typeof a&&null!==a&&"defaultMessage"in a&&"string"==typeof a.defaultMessage?a.defaultMessage:"object"==typeof a&&null!==a&&"children"in a?(n=a.children,"string"==typeof n||"number"==typeof n||"boolean"==typeof n?String(n):null==n?"":Array.isArray(n)?m(n,r+1):_.isValidElement(n)?e(n,r+1):S(n,r+1)):""}(e,t):Array.isArray(e)?m(e,t):""}var h=r(18088);let w=(0,_.createContext)(void 0),E=e=>{var t;if(e instanceof i.LG&&(null==(t=e.extra)?void 0:t.details)&&"object"==typeof e.extra.details&&"error_visibility"in e.extra.details)return String(e.extra.details.error_visibility)};function k(e){var t;let{userFacingMessage:r,error:n,toastId:a,errorContext:o,track:s,isApiError:u}=e,c=S(r),d=c?"".concat(c.substring(0,200)).concat(c.length>200?"...":""):"User-facing error toast",f=c?"User-facing error toast: ".concat(d):"User-facing error toast";s({event_key:"claudeai.user_facing_error.shown",error_message:d,toast_id:a,error_type:n instanceof i.LG?n.type:n instanceof Error?n.name:typeof n,error_source:(null==o||null==(t=o.tags)?void 0:t.source)||"unknown",has_original_error:!!n,original_error_message:n instanceof Error?n.message.substring(0,200):void 0,error_stack_trace:(e=>{if(e instanceof Error&&e.stack)return e.stack.split("\n").slice(0,3).join("\n").substring(0,500)})(n),error_code:(e=>{if(e instanceof i.LG){var t;if(e.errorCode)return e.errorCode;if((null==(t=e.extra)?void 0:t.details)&&"object"==typeof e.extra.details&&"error_code"in e.extra.details&&"string"==typeof e.extra.details.error_code)return e.extra.details.error_code}if(e instanceof Error&&"code"in e)return String(e.code)})(n),error_status_code:(e=>{if(e instanceof Error){if("statusCode"in e&&"number"==typeof e.statusCode)return e.statusCode;if("status"in e&&"number"==typeof e.status)return e.status}})(n),error_visibility:E(n),websocket_close_code:(e=>{var t;if(e instanceof i.LG&&(null==(t=e.extra)?void 0:t.details)&&"object"==typeof e.extra.details&&"websocket_close_code"in e.extra.details&&"number"==typeof e.extra.details.websocket_close_code)return e.extra.details.websocket_close_code})(n),is_instanceof_api_error:n instanceof i.LG,is_caller_api_error:u,offline_status:"undefined"!=typeof navigator?!navigator.onLine:void 0});let g=(null==o?void 0:o.tags)||{},v=(null==o?void 0:o.extra)||{};if(n instanceof Error){let e=Error(f);e.stack=n.stack,(0,l.Cp)(e,{tags:{source:"error-toast",...g},extra:{toastId:a,originalErrorMessage:n.message,originalError:n,...v}})}else n?(0,l.Cp)(Error(f),{tags:{source:"error-toast",errorType:typeof n,...g},extra:{toastId:a,originalError:n,...v}}):(0,l.Cp)(Error(f),{tags:{source:"error-toast",errorType:"string"==typeof r?"string":"react-element",...g},extra:{toastId:a,extractedText:f,...v}})}function I(e){let{children:t}=e,r=(0,_.useRef)(1),[a,i]=(0,_.useState)([]),o=(0,_.useRef)(null),l=(0,_.useRef)(null),s=(0,_.useRef)([]),u=(0,_.useCallback)(e=>{l.current=e,s.current.forEach(t=>{e(t,void 0)}),s.current=[]},[]),c=(0,_.useCallback)(e=>{o.current=e},[]),d=(0,_.useCallback)(async e=>{if(null!==l.current)return l.current(e);s.current.push(e)},[]),f=(0,_.useCallback)(e=>{i(t=>t.filter(t=>t.id!==e))},[]),g=(0,_.useCallback)((e,t)=>{let n=r.current++,{timeout:a,error:o,errorContext:l}=t||{};return k({userFacingMessage:e,error:o,toastId:n,errorContext:l,track:d,isApiError:!1}),i(t=>[...t,{id:n,message:e,toastType:"error"}]),a&&setTimeout(()=>f(n),a),n},[f,d]),v=(0,_.useCallback)((e,t)=>{let n=r.current++,{timeout:a,errorContext:l}=t||{},s=e instanceof Error?e.message:String(e);return k({userFacingMessage:s,error:e,toastId:n,errorContext:l,track:d,isApiError:!0}),o.current&&"user_facing"!==E(e)||i(e=>[...e,{id:n,message:s,toastType:"error"}]),a&&setTimeout(()=>f(n),a),n},[f,d]),y=(0,_.useCallback)((e,t)=>{let n=r.current++;return i(t=>[...t,{id:n,message:e,toastType:"success"}]),t&&setTimeout(()=>f(n),t),n},[f]),p=(0,_.useMemo)(()=>({toasts:a,addError:g,addApiError:v,addSuccess:y,clearToast:f,registerSegmentTracker:u,registerErrorVisibility:c}),[a,g,v,y,f,u,c]);return(0,n.jsx)(w.Provider,{value:p,children:t})}function C(){let e=(0,_.useContext)(w);if(!e)throw Error("Must be called within ErrorsProvider");return e}let L=y.z.object({id:y.z.string().optional().nullable(),title:y.z.string().optional().nullable(),message:y.z.string().optional().nullable(),displayFrequencyHours:y.z.number().optional().nullable()}),x={};function j(){let{registerSegmentTracker:e}=C(),{track:t}=(0,p.st)();return(0,_.useEffect)(()=>{e(t)},[e,t]),null}function T(){let{registerErrorVisibility:e}=C(),{value:t}=(0,o.fS)("claude_ai_error_visibility");return(0,_.useEffect)(()=>{e(t)},[e,t]),null}function M(){var e;let{id:t,title:r,message:n,displayFrequencyHours:i}=(0,o.iW)("claude_system_message",x,L),{account:l}=(0,b.YL)(),s=null!=(e=null==l?void 0:l.uuid)?e:"logged-out",c=(0,v.usePathname)(),[f,y]=(0,h.Vc)("dismissed-system-messages",{}),p=(0,_.useMemo)(()=>()=>y(e=>{let r=u()(e);return t&&g()(r,[s,t],Date.now()),r}),[y,s,t]);return(0,_.useMemo)(()=>{if(!l||(0,a.Xs)(l,!0)||"/download"===c||!t)return!1;let e=d()(f,[s,t]);return!e||"boolean"==typeof e||!!i&&Date.now()-e>=60*i*6e4},[l,t,s,f,i,c])?{currentSystemMessageId:t,currentSystemMessageTitle:r,currentSystemMessageContent:n,dismissCurrentSystemMessage:p}:{currentSystemMessageId:null,currentSystemMessageTitle:null,currentSystemMessageContent:null,dismissCurrentSystemMessage:()=>null}}},61903:(e,t,r)=>{r.d(t,{Q:()=>i,t:()=>a});var n=r(7620);function a(e){var t,r,a;let{key:i,defaultValue:o,deserialize:l=JSON.parse,getInitialValueInEffect:s=!1,sync:u=!0}=e,c="LSS-".concat(i),d=(0,n.useRef)(null!=(a=null==(t=(r=crypto).randomUUID)?void 0:t.call(r))?a:"".concat(Date.now(),"-").concat(Math.random().toString(36).slice(2))),f=(0,n.useRef)(!1),[g,v]=(0,n.useState)(()=>{if(s)return o;try{let e=window.localStorage.getItem(c);if(e){let t=JSON.parse(e);if(t&&"object"==typeof t&&"value"in t)return t.value;return l(e)}}catch(e){console.warn("Error reading localStorage key “".concat(c,"”:"),e)}return o});(0,n.useEffect)(()=>{if(s)try{let e=window.localStorage.getItem(c);if(e){let t=JSON.parse(e);t&&"object"==typeof t&&"value"in t?v(t.value):v(l(e))}}catch(e){console.warn("Error reading localStorage key “".concat(c,"”:"),e)}},[c,l,s]);let _=(0,n.useCallback)(e=>{f.current=!0,v(t=>{let r="function"==typeof e?e(t):e;try{let e={value:r,tabId:d.current,timestamp:Date.now()},t=JSON.stringify(e);if(window.localStorage.setItem(c,t),u){let e=new StorageEvent("storage",{key:c,newValue:t,oldValue:window.localStorage.getItem(c),storageArea:window.localStorage,url:window.location.href});window.dispatchEvent(e)}}catch(e){console.warn("Error writing localStorage key “".concat(c,"”:"),e)}return r}),Promise.resolve().then(()=>{f.current=!1})},[c,u]),y=(0,n.useCallback)(()=>{window.localStorage.removeItem(c),v(o)},[c,o]);return(0,n.useEffect)(()=>{if(!u)return;let e=e=>{if(e.key===c&&e.newValue&&!f.current)try{let t=JSON.parse(e.newValue);if(t&&"object"==typeof t&&"value"in t&&"tabId"in t){if(t.tabId===d.current)return;v(t.value)}else v(l(e.newValue))}catch(e){console.warn("Error handling storage event for “".concat(c,"”:"),e)}};return window.addEventListener("storage",e),()=>window.removeEventListener("storage",e)},[c,u,l]),[g,_,y]}function i(e,t){let r=!(arguments.length>2)||void 0===arguments[2]||arguments[2];return a({key:e,defaultValue:t,deserialize:e=>void 0===e?t:JSON.parse(e),getInitialValueInEffect:!1,sync:r})}},73129:(e,t,r)=>{r.d(t,{Q:()=>s,t:()=>u});var n=r(54568),a=r(99969),i=r.n(a),o=r(7620);let l=(0,o.createContext)({isOpen:!1,dropdownToOpen:void 0,openModal:i(),closeModal:i(),clearCallerIdentifier:i()}),s=e=>{let{children:t}=e,[r,a]=(0,o.useState)(!1),i=(0,o.useRef)(void 0),[s,u]=(0,o.useState)(void 0);return(0,n.jsx)(l.Provider,{value:{isOpen:r,openModal:e=>{a(!0),i.current=e},closeModal:()=>{a(!1),u(i.current)},dropdownToOpen:s,clearCallerIdentifier:()=>{u(void 0)}},children:t})},u=()=>(0,o.useContext)(l)},79052:(e,t,r)=>{r.d(t,{$f:()=>R,K6:()=>N,L5:()=>V,LP:()=>C,U5:()=>j,cI:()=>x,ef:()=>Q,fb:()=>z,kJ:()=>L,qL:()=>A,vT:()=>O,y:()=>T,yy:()=>k,zF:()=>M,zH:()=>D});var n=r(94295),a=r(1613),i=r(64328),o=r(45054),l=r(80688),s=r(68067),u=r(2e3),c=r(28044),d=r(66365),f=r(4869),g=r(27541),v=r(7620),_=r(10369),y=r(94028),p=r(73129),b=r(91958),m=r(3111),S=r(10665),h=r(22167),w=r(40459);let E="gdrive_success",k=()=>{let e=(0,i.mV)(),{data:t}=(0,h.LN)(),r=!!(Array.isArray(t)&&t.find(e=>e.type===u.v8.GDRIVE&&e.enabled));return!e||r},I=()=>{let{value:e}=(0,s.fS)("kingfisher_enabled"),t=(0,d.useLayer)("trials_freemium").get("free_integrations",!1);return e||t},C=()=>{let e=k(),t=I();return!!(!w.env.NEXT_PUBLIC_DISABLE_GDRIVE_INTEGRATION&&t&&e)},L=()=>{let{account:e,activeOrganization:t}=(0,i.YL)(),r=null==t?void 0:t.uuid,n=C(),{data:o,isFetched:s}=(0,a.Sk)("/api/organizations/".concat(r,"/sync/mcp/drive/auth"),{queryKey:[l.jR,{accountUUID:null==e?void 0:e.uuid,orgUuid:r}],enabled:n,staleTime:3e5});return{isAuthenticated:n&&!!(null==o?void 0:o.is_authenticated),isFetched:s}},x=function(){let{callerIdentifier:e,handleAuthSuccess:t,pathname:r,queryString:n}=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{},{isAuthenticated:s,isFetched:u}=L(),{addSuccess:d}=(0,o.Y)(),y=(0,_.A)(),{dropdownToOpen:b,clearCallerIdentifier:S}=(0,p.t)(),w=function(){let e=!(arguments.length>0)||void 0===arguments[0]||arguments[0];null==t||t(e),d(y.formatMessage({defaultMessage:"Successfully connected to Google Drive",id:"7RI6njc31e"}))},k=(e=>{let{callerIdentifier:t,pathname:r,queryString:n}=e,o=(0,g.usePathname)(),{account:s,activeOrganization:u}=(0,i.YL)(),d=null==s?void 0:s.uuid,_=null==u?void 0:u.uuid,y=C(),p=(0,f.useQueryClient)(),b=(0,c.V)(),S=(0,g.useSearchParams)(),{mutate:h}=(0,a.L2)("/api/organizations/".concat(_,"/sync/mcp/drive/auth/start"),"POST",{enabled:y,onSuccess:e=>{window.location.href=e.redirect_url}}),w=(0,v.useRef)(!1);return()=>{if(!y)return;let e="".concat(E,"=").concat(t).concat(n?"&".concat(n):""),a=(0,m.d)({pathname:r||o,searchParams:S,queryString:e,isClaudeApp:b});if(p.invalidateQueries({queryKey:[l.jR,{accountUUID:d,orgUuid:_}]}),b)return void window.open("/settings/connectors?open_in_browser=1&auth_start=gdrive&origin=".concat(a));w.current||(w.current=!0,h({pre_auth_state:{origin:a},redirect_uri:new URL("/connect/mcp/drive/callback",window.location.origin).toString()}))}})({callerIdentifier:e,pathname:r,queryString:n});return(0,h.FZ)({callerIdentifier:e,successParam:E,handleOpen:w}),(0,v.useEffect)(()=>{e&&b===e&&(null==t||t(!0),S())},[b,t,e,S]),{isDriveAuthenticated:s,initDriveAuth:k,handleDriveTrigger:w,isFetched:u}},j=function(){let e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{},{account:t,activeOrganization:r}=(0,i.YL)(),n=null==t?void 0:t.uuid,o=null==r?void 0:r.uuid,s=C(),u=(0,f.useQueryClient)(),{mutate:c}=(0,y.ih)();return(0,a.L2)("/api/organizations/".concat(o,"/sync/mcp/drive/auth"),"DELETE",{enabled:!!(r&&s),...e,onSuccess:function(){for(var t,r=arguments.length,a=Array(r),i=0;i<r;i++)a[i]=arguments[i];u.invalidateQueries({queryKey:[l.jR,{accountUUID:n,orgUuid:o}]}),c({}),null==(t=e.onSuccess)||t.call(e,...a)}})},T=e=>{let{documentId:t}=e,{account:r,activeOrganization:n}=(0,i.YL)(),o=null==r?void 0:r.uuid,s=null==n?void 0:n.uuid,u=C(),c=(0,f.useQueryClient)(),d=(0,a.Sk)("/api/organizations/".concat(s,"/sync/mcp/drive/document/").concat(t,"?include_content=false"),{queryKey:[l.QB,{accountUUID:o,orgUuid:s,documentId:t}],enabled:u,meta:{noToast:!0}}),g=d.isError;return(0,v.useEffect)(()=>{g&&c.invalidateQueries({queryKey:[l.jR,{accountUUID:o,orgUuid:s}]})},[c,g,o,s]),d};function M(e){let{uri:t}=e,{data:r,isLoading:n}=T({documentId:t});return{title:null==r?void 0:r.title,isLoading:n}}let A=e=>{let{account:t,activeOrganization:r}=(0,i.YL)(),n=null==t?void 0:t.uuid,o=null==r?void 0:r.uuid,s=C(),u=(0,v.useMemo)(()=>e.map(e=>"/api/organizations/".concat(o,"/sync/mcp/drive/document/").concat(e)),[e,o]),c=(0,v.useMemo)(()=>({queryKey:e.map(e=>[l.qM,{accountUUID:n,orgUuid:o,documentId:e}]),enabled:s,meta:{noToast:!0}}),[e,n,o,s]);return(0,a._i)(u,c)},D=e=>{let{account:t,activeOrganization:r}=(0,i.YL)(),n=null==t?void 0:t.uuid,o=null==r?void 0:r.uuid,s=C(),u=(0,b.bI)(),{data:c,isSuccess:d,isLoading:f}=(0,a.Sk)("/api/organizations/".concat(o,"/sync/mcp/drive/recents"),{queryKey:[l.zu,{accountUUID:n,orgUuid:o}],enabled:e&&s,meta:{noToast:!0}});return(0,v.useEffect)(()=>{if(d&&c){let e=c.map(e=>{let{uri:t,title:r}=e;return{uri:t,title:r}});(0,b.Ac)(e)}},[d,c]),{recentDriveDocs:d?c:u,isLoading:f}},z=()=>{let e=I(),{value:t}=(0,s.fS)("apps_use_bananagrams"),r=(0,d.useLayer)("trials_freemium").get("free_integrations",!1);return e&&t||r},N=()=>{let e=C(),t=z();return e&&t&&!w.env.NEXT_PUBLIC_DISABLE_GDRIVE_INTEGRATION},R=e=>{var t;let r=N(),{account:n}=(0,i.YL)(),{value:a}=(0,s.fS)("claude_ai_sticky_project_settings"),o=(0,S.v)("enabled_bananagrams");return!!r&&(a?!!o:e?!!(null==e||null==(t=e.conversationSettings)?void 0:t.enabled_bananagrams):!!(null==n?void 0:n.settings.enabled_bananagrams))},V=()=>(0,s.fS)("rag_prototype").value,O=()=>{let e=N(),t=(0,i.mV)(),{data:r}=(0,h.LN)(),{account:n}=(0,i.YL)(),a=V();return!!e&&!!a&&(t?!!(Array.isArray(r)&&r.find(e=>{var t;return e.type===u.v8.GDRIVE&&e.enabled&&(null==(t=e.config)?void 0:t.allow_indexing)})):!!(null==n?void 0:n.settings.enabled_gdrive_indexing))},Q=()=>{let{account:e}=(0,i.YL)(),{mutate:t}=(0,n.Jy)(),{mutate:r}=(0,y.Bg)();return{toggleDriveSearchAndIndexingEnabled:n=>{var a;let{indexingEnabled:i,searchEnabled:o,dismissBanner:l}=n,s=l||!!i;i&&r({}),t({...null==e?void 0:e.settings,...void 0!==i?{enabled_gdrive_indexing:i}:null,...void 0!==o||!0===i?{enabled_bananagrams:null!=i?i:o}:null,...s?{dismissed_claudeai_banners:[...(null==e||null==(a=e.settings)?void 0:a.dismissed_claudeai_banners)||[],{banner_id:"drive_indexing_enablement_2/11_1",dismissed_at:new Date().toISOString()}]}:null})}}}}}]);