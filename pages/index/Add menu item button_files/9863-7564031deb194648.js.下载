try{let e="undefined"!=typeof window?window:"undefined"!=typeof global?global:"undefined"!=typeof globalThis?globalThis:"undefined"!=typeof self?self:{},t=(new e.Error).stack;t&&(e._sentryDebugIds=e._sentryDebugIds||{},e._sentryDebugIds[t]="a410fc81-2f95-4ef7-96f3-fb941188a668",e._sentryDebugIdIdentifier="sentry-dbid-a410fc81-2f95-4ef7-96f3-fb941188a668")}catch(e){}"use strict";(self.webpackChunk_N_E=self.webpackChunk_N_E||[]).push([[9863],{41977:(e,t,s)=>{s.d(t,{k:()=>k});var a=s(54568),n=s(45054),l=s(58720),i=s(23812),r=s(3075),d=s(84617),o=s(68067),c=s(72902),u=s(7620),x=s(10369),m=s(59666),p=s(45538),h=s(49638),f=s(21266),g=s(2e3),j=s(24407),v=s(8468),y=s(74326),b=s(35391),w=s(83226),M=s(92245),N=s(35580),S=s(72178);function A(e){let{onClose:t,project:s}=e,{manageFromOrg:n}=(0,w.lg)(),{mutateAsync:l}=(0,p.sS)(s.uuid),c=(0,u.useMemo)(()=>(e=>{let t=[];return e.enabled_web_search&&t.push("web_search"),"extended"===e.paprika_mode&&t.push("extended_thinking"),"advanced"===e.compass_mode&&t.push("research"),e.enabled_bananagrams&&t.push(g.v8.GDRIVE),e.enabled_sourdough&&t.push(g.v8.GMAIL),e.enabled_foccacia&&t.push(g.v8.GCAL),e.recommended_mcp_servers&&t.push(...e.recommended_mcp_servers),t})(s.settings),[s.settings]),[h,A]=(0,u.useState)(c),k=(()=>{let e=(0,y.J)(),t=(0,b.YW)(),s=(0,v.Ow)(),a=(0,x.A)(),n=[];return e&&n.push((0,S.bF)(a,!0)),t&&n.push((0,S.aD)(a,!0)),s&&n.push((0,S.v9)(a,!0)),n})(),C=[...(()=>{let e=(0,x.A)(),t=(0,M.Xd)(),s=(0,o.T9)("claude_ai_haystack_integrations","integrations",[],j.z.array(j.z.string()));return(0,u.useMemo)(()=>t.filter(e=>e.enabledForOrg&&s.includes(e.type)).map(t=>(0,S.q)(e,t.type,!!t.connected)),[t,s,e])})(),...(()=>{let e=(0,x.A)();return(0,N.Uz)().map(t=>(0,S.aW)(e,t,!!t.isConnected))})()],D=e=>{A(t=>t.includes(e)?t.filter(t=>t!==e):[...t,e])},U=async()=>{let e=(e=>{let t={enabled_web_search:!1,paprika_mode:null,compass_mode:null,enabled_bananagrams:!1,enabled_sourdough:!1,enabled_foccacia:!1,recommended_mcp_servers:[]};for(let s of e)"web_search"===s?t.enabled_web_search=!0:"extended_thinking"===s?t.paprika_mode="extended":"research"===s?t.compass_mode="advanced":s===g.v8.GDRIVE?t.enabled_bananagrams=!0:s===g.v8.GMAIL?t.enabled_sourdough=!0:s===g.v8.GCAL?t.enabled_foccacia=!0:(t.recommended_mcp_servers||(t.recommended_mcp_servers=[]),t.recommended_mcp_servers.push(s));return t})(h);await l({settings:e}),t()},E=()=>{A(c),t()};return(0,a.jsxs)(a.Fragment,{children:[(0,a.jsxs)("div",{className:"flex flex-col gap-1 mb-3",children:[(0,a.jsx)("h2",{className:"font-xl-bold",children:(0,a.jsx)(f.YX,{id:"ruby_sandstorm_journey"})}),(0,a.jsx)("div",{className:"text-text-300 text-sm",children:n?(0,a.jsxs)(a.Fragment,{children:[(0,a.jsx)(f.YX,{id:"emerald_sunset_path"})," ",(0,a.jsx)(m.A,{defaultMessage:"You can add more connectors in <settingsLink>settings</settingsLink>.",id:"PgczbjXwzO",values:{settingsLink:e=>(0,a.jsx)(d.Y,{href:"/settings/connectors?tab=organization",children:e})}})]}):(0,a.jsxs)(a.Fragment,{children:[(0,a.jsx)(f.YX,{id:"emerald_sunset_path"})," ",(0,a.jsx)(m.A,{defaultMessage:"Your admin can add more connections for your organization.",id:"Pc4vMb0/Wf"})]})})]}),(0,a.jsx)("div",{className:"flex flex-col gap-4",children:0===k.length&&0===C.length?(0,a.jsx)("div",{className:"text-text-400 font-large",children:(0,a.jsx)(m.A,{defaultMessage:"No available tools.",id:"ES4xSBiZh2"})}):(0,a.jsxs)("div",{className:"flex flex-col gap-4",children:[k.length>0&&(0,a.jsxs)("div",{className:"bg-bg-000 rounded-lg p-4",children:[(0,a.jsx)("h3",{className:"text-text-300 text-sm mb-2",children:(0,a.jsx)(m.A,{defaultMessage:"Tools",id:"nUT0LvZVOx"})}),(0,a.jsx)("div",{className:"flex flex-col gap-4",children:k.map(e=>(0,a.jsx)(_,{connector:e,isSelected:h.includes(e.id),onToggle:()=>D(e.id)},e.id))})]}),C.length>0&&(0,a.jsxs)("div",{className:"bg-bg-000 rounded-lg p-4",children:[(0,a.jsx)("h3",{className:"text-text-300 text-sm mb-2",children:(0,a.jsx)(m.A,{defaultMessage:"Connectors",id:"2mMJRvsAg1"})}),(0,a.jsx)("div",{className:"flex flex-col gap-4",children:C.map(e=>(0,a.jsx)(_,{connector:e,isSelected:h.includes(e.id),onToggle:()=>D(e.id)},e.id))})]})]})}),0===k.length&&0===C.length?(0,a.jsx)(r.vW,{children:(0,a.jsx)(i.$,{variant:"secondary",onClick:E,children:(0,a.jsx)(m.A,{defaultMessage:"Cancel",id:"47FYwba+bI"})})}):(0,a.jsxs)(r.vW,{children:[(0,a.jsx)(i.$,{variant:"secondary",onClick:E,children:(0,a.jsx)(m.A,{defaultMessage:"Cancel",id:"47FYwba+bI"})}),(0,a.jsx)(i.$,{variant:"primary",onClick:U,children:(0,a.jsx)(m.A,{defaultMessage:"Add tools",id:"5fVEetLkuE"})})]})]})}function _(e){let{connector:t,isSelected:s,onToggle:n}=e;return(0,a.jsx)(l.Sc,{checked:s,onChange:n,"aria-label":t.name,labelClassName:"flex-row-reverse justify-between",label:(0,a.jsxs)("div",{className:(0,c.A)("flex flex-row gap-3 items-center"),children:[(0,a.jsx)("div",{className:"flex items-center justify-center w-7 h-7 rounded-lg border border-border-300",children:t.icon}),(0,a.jsx)("div",{className:"flex-1 min-w-0",children:(0,a.jsx)("div",{className:"text-sm font-base text-text-300",children:t.name})})]})})}function k(e){let{currentView:t,setCurrentView:s,onClose:f,project:g,viewOnly:j}=e,v=(0,x.A)(),[y,b]=(0,u.useState)(g.prompt_template),[w,M]=(0,u.useState)(!1),{value:N}=(0,o.fS)("claudeai_custom_styles"),{value:S}=(0,o.fS)("claude_ai_cayenne"),{addError:_}=(0,n.Y)(),{mutateAsync:k}=(0,p.sS)(g.uuid),C=async()=>{M(!0);try{await k({prompt_template:y}),f(),M(!1)}catch(e){_(v.formatMessage({defaultMessage:"Error saving instructions, please try again later",id:"WL3FdCcP2y"}),{error:e}),M(!1)}},D=g.prompt_template.length>0&&0===y.length,U=S?(0,a.jsx)(m.A,{defaultMessage:"This will work alongside <link>user preferences</link> and the selected style in a chat.",values:{link:e=>(0,a.jsx)(d.Y,{href:"/settings/profile",children:e})},id:"NlixH3av58"}):(0,a.jsx)(m.A,{defaultMessage:"This will work alongside the selected style in a chat.",id:"rptxrPz/Y3"});return(0,a.jsx)(r.aF,{isOpen:void 0!==t,onClose:()=>{s("instructions"),f()},modalSize:"instructions"===t?"xl":"md",children:"instructions"===t?(0,a.jsxs)(a.Fragment,{children:[(0,a.jsxs)("div",{className:"flex flex-col gap-1",children:[(0,a.jsx)("h2",{className:"font-xl-bold",children:j?(0,a.jsx)(m.A,{defaultMessage:"Project instructions",id:"1vND0qQgVb"}):(0,a.jsx)(m.A,{defaultMessage:"Set project instructions",id:"+On7CFwfGv"})}),!j&&(0,a.jsxs)("p",{className:"text-text-300 text-sm",children:[(0,a.jsx)(m.A,{defaultMessage:"Provide Claude with relevant instructions and information for chats within {projectName}.",id:"NM6ePuQ0y+",values:{projectName:g.name}}),"\xa0",N&&U]})]}),(0,a.jsx)("div",{className:"mb-6 mt-3",children:(0,a.jsx)(l.fs,{"data-testid":"custom-instructions-textarea",value:y,onChange:e=>b(e.target.value),readOnly:j,placeholder:[v.formatMessage({defaultMessage:"Think step by step and show reasoning for complex problems. Use specific examples.",id:"j554E3Ar1K"}),v.formatMessage({defaultMessage:"Break down large tasks and ask clarifying questions when needed.",id:"H/tJ47E9to"}),v.formatMessage({defaultMessage:"Use Artifacts only for web apps and code demos.",id:"U50hIJOW7M"}),v.formatMessage({defaultMessage:"When giving feedback, explain thought process and highlight issues and opportunities.",id:"f2YGj7vTV3"})],minRows:16,required:!0,customScrollbar:!0,className:(0,c.A)("max-h-80",j&&"!opacity-100 focus:!outline-none")})}),(0,a.jsx)(h.C,{project:g,canEditKnowledgeBase:!j,includeTitle:!0,size:"md",addToolsButtonVariant:"outline",inlineEdit:!j,onEditClick:()=>s("tools")}),(0,a.jsx)("div",{className:"mt-2 flex justify-end gap-2",children:j?(0,a.jsx)(i.$,{variant:"secondary",onClick:f,children:(0,a.jsx)(m.A,{defaultMessage:"Close",id:"rbrahOGMC3"})}):(0,a.jsxs)(a.Fragment,{children:[(0,a.jsx)(i.$,{variant:"secondary",onClick:f,children:(0,a.jsx)(m.A,{defaultMessage:"Cancel",id:"47FYwba+bI"})}),(0,a.jsx)(i.$,{loading:w,disabled:g.prompt_template===y,onClick:()=>{C()},children:D?(0,a.jsx)(m.A,{defaultMessage:"Clear instructions",id:"aHS9gkqH/s"}):(0,a.jsx)(m.A,{defaultMessage:"Save instructions",id:"wtm6MF4hNg"})})]})})]}):(0,a.jsx)(A,{project:g,onClose:()=>s(void 0)})})}},48911:(e,t,s)=>{s.d(t,{m:()=>u});var a=s(54568),n=s(64328),l=s(13910),i=s(27541),r=s(7620),d=s(59666),o=s(47831),c=s(2722);function u(e){let{children:t}=e,s=(0,i.useRouter)(),u=(0,n.h0)(),x=(0,o.aT)(),[m,p]=(0,r.useState)(!1),h=(0,r.useCallback)(()=>{x&&!u?p(!0):s.push("/projects/create")},[x,u,s]);return(0,a.jsxs)(a.Fragment,{children:[(0,a.jsx)(l.Tooltip,{tooltipContent:(0,a.jsxs)("div",{className:"max-w-48 p-1",children:[(0,a.jsx)("p",{className:"mb-2 whitespace-break-spaces text-xs",children:(0,a.jsx)(d.A,{defaultMessage:"This is an example project. Create a new project to work with your own documents.",id:"aod9/juMdU"})}),(0,a.jsx)("button",{onClick:h,className:"text-accent-secondary-200 text-xs hover:underline cursor-pointer bg-transparent border-none p-0",children:(0,a.jsx)(d.A,{defaultMessage:"Create new project",id:"a7FtAnfVfj"})})]}),children:t}),(0,a.jsx)(c.S,{isOpen:m,onClose:()=>p(!1),limitType:"projects"})]})}},49638:(e,t,s)=>{s.d(t,{C:()=>y});var a=s(54568),n=s(21266),l=s(63911),i=s(23812),r=s(13910),d=s(68067),o=s(2e3),c=s(72902),u=s(7620),x=s(10369),m=s(59666),p=s(24407),h=s(10665),f=s(92245),g=s(35580),j=s(72178);let v=function(e,t){let s=arguments.length>2&&void 0!==arguments[2]?arguments[2]:"sm",a=(0,x.A)(),n=e.settings,l=(0,h.v)("enabled_web_search"),i=(0,h.v)("paprika_mode"),r=(0,h.v)("compass_mode"),c=(0,h.v)("enabled_bananagrams"),m=(0,h.v)("enabled_sourdough"),v=(0,h.v)("enabled_foccacia"),y=(0,h.v)("enabled_mcp_tools"),b=(0,g.Uz)(),w=(0,f.Xd)(),M=(0,d.T9)("claude_ai_haystack_integrations","integrations",[],p.z.array(p.z.string())),N=(0,u.useMemo)(()=>w.filter(e=>e.available&&e.enabledForOrg&&M.includes(e.type)).map(e=>e.type),[w,M]),S=[];if((null==n?void 0:n.paprika_mode)==="extended"&&S.push((0,j.bF)(a,"extended"===i,t,s)),(null==n?void 0:n.enabled_web_search)&&S.push((0,j.aD)(a,!!l,t,s)),(null==n?void 0:n.compass_mode)==="advanced"&&S.push((0,j.v9)(a,"advanced"===r,t,s)),(null==n?void 0:n.enabled_bananagrams)&&N.includes(o.v8.GDRIVE)){let e=w.find(e=>e.type===o.v8.GDRIVE),n=!!c&&!!(null==e?void 0:e.connected);S.push((0,j.q)(a,o.v8.GDRIVE,n,t,s))}if((null==n?void 0:n.enabled_sourdough)&&N.includes(o.v8.GMAIL)){let e=w.find(e=>e.type===o.v8.GMAIL),n=!!m&&!!(null==e?void 0:e.connected);S.push((0,j.q)(a,o.v8.GMAIL,n,t,s))}if((null==n?void 0:n.enabled_foccacia)&&N.includes(o.v8.GCAL)){let e=w.find(e=>e.type===o.v8.GCAL),n=!!v&&!!(null==e?void 0:e.connected);S.push((0,j.q)(a,o.v8.GCAL,n,t,s))}if(null==n?void 0:n.recommended_mcp_servers){let e=new Set(n.recommended_mcp_servers);b.forEach(n=>{if(!e.has(n.uuid))return;let l=!1;for(let e of n.tools)if(!y||!(e.enabledKey in y)||!1!==y[e.enabledKey]){l=!0;break}S.push((0,j.aW)(a,n,l,t,s))})}return S},y=e=>{let{project:t,canEditKnowledgeBase:s,onConnectorClick:r,includeTitle:o=!1,size:c="sm",addToolsButtonVariant:u="ghost",showErrors:x=!1,inlineEdit:p=!1,onEditClick:h}=e,f=v(t,r,c),{value:g}=(0,d.fS)("haystack_enabled"),j=f.some(e=>!e.isConnected);return g&&(s||0!==f.length)?(0,a.jsx)(a.Fragment,{children:0===f.length?(0,a.jsx)(i.$,{prepend:(0,a.jsx)(l.OM,{size:12}),onClick:()=>null==h?void 0:h(),variant:u,className:"text-xs",children:(0,a.jsx)(m.A,{defaultMessage:"Add Tools",id:"+yfT26TN4F"})}):(0,a.jsxs)(a.Fragment,{children:[o&&(0,a.jsx)("p",{className:"mb-2 font-semibold text-text-300 text-sm",children:(0,a.jsx)(n.YX,{id:"sapphire_forest_dream"})}),(0,a.jsxs)("div",{className:"flex flex-col gap-2",children:[(0,a.jsxs)("div",{className:"flex flex-wrap gap-1",children:[f.map(e=>(0,a.jsx)(b,{connector:e,size:c,showErrors:x},e.id)),p&&(0,a.jsx)(i.$,{onClick:()=>null==h?void 0:h(),variant:"ghost",size:"icon_sm",children:(0,a.jsx)(l.ff,{size:16})})]}),x&&j&&(0,a.jsxs)("div",{className:"flex items-center gap-2 text-xs text-text-500",children:[(0,a.jsx)(m.A,{defaultMessage:"Tools missing",id:"eGa/wm/gxG"}),(0,a.jsx)("span",{className:"text-border-200",children:"∙"}),(0,a.jsx)(i.$,{onClick:()=>null==r?void 0:r(),variant:"unstyled",size:"unset",className:"!p-0 text-xs underline hover:opacity-70",children:(0,a.jsx)(m.A,{defaultMessage:"Connect",id:"+vVZ/G11Zg"})})]})]})]})}):null},b=e=>{let{connector:t,size:s="sm",showErrors:n=!1}=e,l=n&&!t.isConnected?"opacity-30":"opacity-100";return(0,a.jsx)(r.Tooltip,{tooltipContent:t.name,side:"top",children:(0,a.jsx)("div",{onClick:t.onClick,className:(0,c.A)("flex items-center bg-bg-000 justify-center rounded-md border transition-all border-border-300",l,"sm"===s&&"w-6 h-6","md"===s&&"w-8 h-8",!!t.onClick&&"cursor-pointer"),children:t.icon})})}},51461:(e,t,s)=>{s.d(t,{H:()=>ei,w:()=>Z});var a=s(54568),n=s(44894),l=s(45054),i=s(58720),r=s(63911),d=s(9398),o=s(23812),c=s(87483),u=s(3075),x=s(13910),m=s(43465),p=s(68067),h=s(2e3),f=s(19977),g=s(85524),j=s(72902),v=s(7620),y=s(10369),b=s(59666),w=s(34385),M=s(45538),N=s(79052),S=s(36016),A=s(18050),_=s(47831),k=s(48911),C=s(20746),D=s(45271),U=s(96469),E=s(74428),I=s(88716),P=s(23169),O=s(86141),T=s(93714),z=s(84284),L=s(10665);function R(e){let{conversation:t}=e,s=(0,N.K6)(),n=(0,N.$f)(t),{toggleConversationSetting:l}=(0,L.r)();return s?(0,a.jsx)("div",{className:"px-2 py-1.5 -mx-1 -mb-1 border-t-0.5 border-border-300 hover:bg-bg-200",children:(0,a.jsxs)(c.tJ,{className:"flex flex-row gap-4 cursor-pointer px-2 pt-1 pb-2",onSelect:e=>{e.stopPropagation(),e.preventDefault(),l("enabled_bananagrams",!n)},onPointerLeave:e=>e.preventDefault(),onPointerMove:e=>e.preventDefault(),children:[(0,a.jsxs)("div",{className:"flex flex-col",children:[(0,a.jsx)("p",{children:(0,a.jsx)(b.A,{defaultMessage:"Allow Claude to search",id:"zyxxt7OHPv"})}),(0,a.jsx)("p",{className:"text-xs text-text-400",children:(0,a.jsx)(b.A,{defaultMessage:"Claude will search for relevant documents",id:"JxbYvAvtdV"})})]}),(0,a.jsx)(z.j,{checked:n,readOnly:!0})]})}):null}var F=s(25548),G=s(54787);function V(e){let{title:t,url:s,isLoading:n,isError:l,isLink:i=!1,defaultErrorTitle:r,defaultDocumentTitle:d}=e,o=(0,a.jsx)("p",{children:d});return(l?o=(0,a.jsx)("p",{children:r}):!n||t||d?t&&(o=(0,a.jsx)("p",{children:t})):o=(0,a.jsx)(G.j,{variant:"light",className:"rounded-md",height:18}),i&&s)?(0,a.jsx)("a",{href:s,target:"_blank",rel:"noopener noreferrer",children:o}):o}function K(e){let{uri:t,isError:s,isLink:n=!1}=e,{data:l,isLoading:i}=(0,N.y)({documentId:t}),r=(0,F.d)(t);return(0,a.jsx)(V,{title:null==l?void 0:l.title,url:r,isLoading:i,isError:s,isLink:n,defaultErrorTitle:"Google Docs"})}var W=s(51561),Y=s(49629);let B={includeScore:!0,threshold:.3,keys:["title"],ignoreLocation:!0},q=e=>{let{conversation:t,projectUuid:s,trigger:n,align:r,isSubDropdown:d=!1,setIsUploadingDriveSync:o,onCreated:u,isOpen:x,setIsOpen:f,closeWholeDropdown:g=()=>f(!1),shouldAddSyncUponPaste:j}=e,b=(0,y.A)(),{value:w}=(0,p.fS)("kingfisher_prefetch"),{recentDriveDocs:M,isLoading:S}=(0,N.zH)(w||x),[A,_]=(0,v.useState)(""),[k,C]=(0,v.useState)(!1),[D,U]=(0,v.useState)(""),{addError:E}=(0,l.Y)(),I=(0,v.useRef)(null),z=(0,v.useRef)(null),L=()=>{o(!0),C(!0)},F=e=>{null==u||u(e),g(),C(!1)},G=e=>{o(!1),C(!1),E((0,Y.J)(e),{error:e})},{mutate:V}=(0,O.EF)({onMutate:L,onSuccess:F,onError:G,meta:{noToast:!0}}),{mutate:K}=(0,T.pz)(s,{onMutate:L,onSuccess:F,onError:G,meta:{noToast:!0}}),q=(0,v.useMemo)(()=>M&&A?new P.A(M,B).search(A).map(e=>e.item):M,[M,A]),X=A?null==q?void 0:q.slice(0,7):null==M?void 0:M.slice(0,5),$=e=>{g(),(s?K:V)({sync_source_type:h.v8.GDRIVE,sync_source_config:{uri:e}})},H=e=>{let t=(0,W.$)(e);_(e);let s="";if(t)$(t);else if((0,W.X)(e))s=b.formatMessage({defaultMessage:"Only Google Docs are supported at this time",id:"P3m20xflVA"});else try{new URL(e),s=b.formatMessage({defaultMessage:"Not a valid Google Doc URL",id:"S//j6oF0j8"})}catch(e){}U(s)};(0,m.y)({target:I,shouldFocus:x}),(0,v.useEffect)(()=>{x||(_(""),C(!1),U(""))},[x,_,C,U]);let Z=!!s,Q=d?c.FV:c.ms;return(0,a.jsxs)(Q,{className:"text-md w-[332px] p-0 overflow-hidden",align:r,trigger:n,onKeyDown:e=>{if(!["Enter","ArrowDown","ArrowUp"].includes(e.key)){var t;null==(t=I.current)||t.focus()}},onFocusOutside:e=>e.preventDefault(),...d?{forceMount:!0}:{open:x,onOpenChange:f,unstyledTrigger:!0},children:[(0,a.jsx)(c.Bi,{children:(0,a.jsx)(i.ks,{ref:I,value:A,placeholder:b.formatMessage({defaultMessage:"Search recents or paste URL",id:"jprBObbn5b"}),className:"w-full bg-inherit border-none select-none",onChange:e=>{H(e.target.value)},onPasteCapture:e=>{if(e.stopPropagation(),!x)return;let t=e.clipboardData.getData("text"),s=(0,W.$)(t);s&&j&&$(s)},onKeyDown:e=>{if("ArrowLeft"===e.key&&A)e.stopPropagation();else if("Enter"===e.key)H(e.currentTarget.value);else if("ArrowDown"===e.key&&X&&X.length>0){var t;e.preventDefault(),null==(t=z.current)||t.focus()}},"data-1p-ignore":!0,autoComplete:"off",autoFocus:!0})}),(0,a.jsx)(J,{inputRef:I,firstDocumentRef:z,handleAddDocument:$,documents:X,isValidatingUrl:k,isFetchingRecentDriveDocs:S,errorMessage:D}),!Z&&!A&&(0,a.jsx)(R,{conversation:t})]})},J=e=>{let{inputRef:t,firstDocumentRef:s,handleAddDocument:n,documents:l,isValidatingUrl:i,isFetchingRecentDriveDocs:r,errorMessage:o}=e,u=i||r&&!l.length,x=!!o,m=!u&&(!l||!l.length);return u?(0,a.jsx)("div",{className:"flex flex-col items-center justify-center h-[220px]",children:(0,a.jsx)(E.y,{className:"animate-spin mx-auto"})}):x?(0,a.jsxs)("div",{className:"flex flex-col items-center justify-center h-[220px] text-center",children:[(0,a.jsx)(I.i,{size:24,className:"text-text-400",weight:"duotone"}),(0,a.jsx)("p",{className:"text-md text-text-400 mt-4",children:(0,a.jsx)(b.A,{defaultMessage:"Invalid URL",id:"SASA4f9KO3"})}),(0,a.jsx)("p",{className:"text-sm text-danger-000",children:o})]}):m?(0,a.jsxs)("div",{className:"flex flex-col items-center justify-center h-[220px]",children:[(0,a.jsx)(I.i,{size:24,className:"text-text-400",weight:"duotone"}),(0,a.jsx)("p",{className:"text-md text-text-400 mt-4",children:(0,a.jsx)(b.A,{defaultMessage:"No recents found",id:"2FzJykASLO"})}),(0,a.jsx)("p",{className:"text-sm text-text-500",children:(0,a.jsx)(b.A,{defaultMessage:"Try pasting the URL instead",id:"jf3/+bX0lc"})})]}):(0,a.jsx)("div",{className:"px-1.5 py-1",children:l.map((e,l)=>{let{uri:i,title:r}=e;return(0,a.jsxs)(c.tJ,{className:"!grid-cols-[max-content_auto] hover:text-text-000 hover:bg-bg-200",ref:0===l?s:void 0,onClick:()=>n(i),onKeyDown:e=>{if("ArrowUp"===e.key&&0===l){var s;e.preventDefault(),null==(s=t.current)||s.focus()}},textValue:"",onPointerLeave:e=>e.preventDefault(),onPointerMove:e=>e.preventDefault(),children:[(0,a.jsx)(d.A9,{type:h.v8.GDRIVE,variant:d.UF.DOCS,size:16}),(0,a.jsx)("span",{className:"truncate",children:null!=r?r:(0,a.jsx)(K,{uri:i})})]},i)})})};var X=s(35580),$=s(43341);function H(e){let{server:t,projectUuid:s,_setIsOpen:n,closeWholeDropdown:d,setIsUploadingMcpSync:o}=e,u=(0,y.A)(),{addError:x}=(0,l.Y)(),[p,f]=(0,v.useState)(""),[g,j]=(0,v.useState)(!1),[w,M]=(0,v.useState)(""),N=(0,v.useRef)(null),S=(0,v.useRef)(null),{mutateAsync:A}=(0,T.pz)(s),_=(0,v.useMemo)(()=>{if(!t.resources||!p)return t.resources;let e=p.toLowerCase();return t.resources.filter(t=>{var s,a,n;let l=(null==(s=t.name)?void 0:s.toLowerCase())||"",i=(null==(a=t.description)?void 0:a.toLowerCase())||"",r=(null==(n=t.uri)?void 0:n.toLowerCase())||"";return l.includes(e)||i.includes(e)||r.includes(e)})},[t.resources,p]),k=(0,v.useCallback)(async e=>{try{null==o||o(!0),j(!0),d();let s=e.name||null;!s&&e.description&&(s=e.description),await A({sync_source_type:h.v8.MCP_RESOURCES,sync_source_config:{server_uuid:t.uuid,resource:{name:e.name,uri:e.uri,mimeType:e.mimeType||null,title:s||null,size:null}}}),j(!1)}catch(e){null==o||o(!1),j(!1),x(u.formatMessage({defaultMessage:"Failed to add MCP resource",id:"dmO4UZ//Vk"}),{error:e})}},[t,A,x,u,d,o]),C=(0,v.useCallback)(async e=>{try{j(!0),M("");let s=(0,X.KU)(t.uuid),a=t.resources.find(t=>t.uri===e);if(a)return void await k(a);let n=await s.readResource({uri:e},{timeout:5e3});if(n.contents.length>0){let t={uri:e,name:e.split("/").pop()||e,mimeType:n.contents[0].mimeType};await k(t)}else M(u.formatMessage({defaultMessage:"Unable to resolve URL through MCP server",id:"dkdRVRDQNR"}))}catch(e){j(!1),M(u.formatMessage({defaultMessage:"Failed to resolve URL. Make sure the MCP server supports this URL.",id:"CUJtqLGhMn"}))}},[t,k,u]),D=(0,v.useCallback)(e=>{e.stopPropagation();let t=e.clipboardData.getData("text");(0,$.q)(t)&&(e.preventDefault(),C(t))},[C]),U=(0,v.useCallback)(e=>{if("ArrowLeft"===e.key&&p)e.stopPropagation();else if("Enter"===e.key){let t=e.currentTarget.value;(0,$.q)(t)&&C(t)}else if("ArrowDown"===e.key&&_&&_.length>0){var t;e.preventDefault(),null==(t=S.current)||t.focus()}},[p,_,C]),P=(0,v.useCallback)(e=>{if(!["Enter","ArrowDown","ArrowUp"].includes(e.key)){var t;null==(t=N.current)||t.focus()}},[]);(0,m.y)({target:N,shouldFocus:!0});let O=!!w,z=!g&&(!_||!_.length);return(0,a.jsxs)(c.FV,{className:"text-md w-[332px] p-0 overflow-hidden",forceMount:!0,onKeyDown:P,onFocusOutside:e=>e.preventDefault(),children:[(0,a.jsx)(c.Bi,{children:(0,a.jsx)(i.ks,{ref:N,value:p,placeholder:u.formatMessage({defaultMessage:"Search resources or paste URL",id:"fctiBd7NOX"}),className:"w-full bg-inherit border-none select-none",onChange:e=>{f(e.target.value),M("")},onPaste:D,onKeyDown:U,"data-1p-ignore":!0,autoComplete:"off",autoFocus:!0})}),g&&(0,a.jsx)("div",{className:"flex flex-col items-center justify-center h-[220px]",children:(0,a.jsx)(E.y,{className:"animate-spin mx-auto"})}),O&&(0,a.jsxs)("div",{className:"flex flex-col items-center justify-center h-[220px] text-center",children:[(0,a.jsx)(I.i,{size:24,className:"text-text-400",weight:"duotone"}),(0,a.jsx)("p",{className:"text-md text-text-400 mt-4",children:(0,a.jsx)(b.A,{defaultMessage:"Invalid URL",id:"SASA4f9KO3"})}),(0,a.jsx)("p",{className:"text-sm text-danger-000",children:w})]}),z&&!O&&(0,a.jsxs)("div",{className:"flex flex-col items-center justify-center h-[220px]",children:[(0,a.jsx)(I.i,{size:24,className:"text-text-400",weight:"duotone"}),(0,a.jsx)("p",{className:"text-md text-text-400 mt-4",children:(0,a.jsx)(b.A,{defaultMessage:"No resources found",id:"FAyfWZv8kx"})}),(0,a.jsx)("p",{className:"text-sm text-text-500",children:(0,a.jsx)(b.A,{defaultMessage:"Try adjusting your search or paste a URL",id:"dDjPrmrUBk"})})]}),!g&&!O&&_&&_.length>0&&(0,a.jsx)("div",{className:"px-1.5 py-1",children:_.map((e,t)=>(0,a.jsxs)(c.tJ,{ref:0===t?S:void 0,onClick:()=>void k(e),onKeyDown:e=>{if("ArrowUp"===e.key&&0===t){var s;e.preventDefault(),null==(s=N.current)||s.focus()}},className:"!grid-cols-[max-content_auto] hover:text-text-000 hover:bg-bg-200",textValue:"",onPointerLeave:e=>e.preventDefault(),onPointerMove:e=>e.preventDefault(),children:[(0,a.jsx)(r.ZH,{size:16}),(0,a.jsx)("span",{className:"truncate",children:e.name||e.uri})]},e.uri))})]})}let Z=e=>{let{projectUuid:t,isStarterProject:s,isUploading:i,setIsUploadingDoc:r,setIsUploadingGithubSync:d,setIsUploadingDriveSync:o,setIsUploadingOutlineSync:c,setIsUploadingMcpSync:u}=e,x=(0,y.A)(),m=(0,v.useRef)(null),[h,f]=(0,v.useState)(""),[g,j]=(0,v.useState)(""),[k,C]=(0,v.useState)(!1),[D,E]=(0,v.useState)(!1),[I,P]=(0,v.useState)(!1),{addError:O}=(0,l.Y)(),{mutateAsync:T}=(0,w.fh)(t,{onError:()=>r(!1)}),{data:z}=(0,M.fo)(t),{checkIsGithubAuthenticated:L,initGithubAuth:R}=(0,S.nB)({callerIdentifier:"project",toggleGithubModalOpen:E}),F=(0,S.Cq)(),{isOutlineAuthenticated:G}=(0,A.I5)(),V=(0,A.AI)(),K=(0,N.LP)(),W=(0,_.ED)(t),{maxKbTokens:Y}=(0,_.AO)(),B=(null!=W?W:0)>Y,q=(0,n.cV)(),{value:J}=(0,p.fS)("project_image"),{handleProjectFileUpload:X}=(0,_.IE)({projectUuid:t,onError:()=>r(!1)}),$=(0,v.useCallback)(async e=>{let t=e.target.files;t&&(r(!0),await X(Array.from(t),Y-(null!=W?W:0)),r(!1)),e.target.value=""},[X,r,W,Y]),H=async()=>{try{C(!1),r(!0),await T({file_name:g,content:h}),j(""),f("")}catch(e){r(!1),O(x.formatMessage({defaultMessage:"Error saving text content",id:"9U64gLEIVo"}),{error:e})}};return(0,a.jsxs)(a.Fragment,{children:[(0,a.jsx)("input",{"data-testid":"project-doc-upload",ref:m,type:"file",className:"hidden",accept:(0,n.cm)({imagesEnabled:J,outOfContextFilesEnabled:q}).join(","),onChange:$,multiple:!0}),(0,a.jsx)(Q,{projectUuid:t,shouldShowGithubSyncSource:F,shouldShowDriveSyncSource:K,shouldShowOutlineSyncSource:V,handleGithubClick:()=>{L().then(e=>{if(e)return void E(!0);R()})},handleOutlineClick:()=>{G?P(!0):O((0,a.jsxs)("div",{className:"flex flex-col items-start",children:[(0,a.jsx)("div",{children:(0,a.jsx)(b.A,{defaultMessage:"You need to connect to Outline before using this feature.",id:"PejG+e4wN5"})}),(0,a.jsx)("button",{onClick:()=>{window.location.href="/settings/profile"},className:"mt-2 underline",children:(0,a.jsx)(b.A,{defaultMessage:"Connect to Outline",id:"m1DuTWXorQ"})})]}))},handleFileUploadClick:()=>{m.current&&m.current.click()},handleTextContentClick:()=>C(!0),isPrivateProject:!!(null==z?void 0:z.is_private),isStarterProject:s,isOverProjectKnowledgeLimit:B,isLoading:i,setIsUploadingDriveSync:o,setIsUploadingMcpSync:u}),(0,a.jsx)(el,{isOpen:k,onClose:()=>C(!1),title:g,setTitle:j,content:h,setContent:f,onSave:H}),F&&(0,a.jsx)(U.s,{location:"project",isOpen:D,onClose:()=>E(!1),projectUuid:t,setIsUploadingGithubSync:d}),V&&""]})},Q=e=>{let{projectUuid:t,shouldShowGithubSyncSource:s,shouldShowDriveSyncSource:n,handleGithubClick:l,handleFileUploadClick:i,handleTextContentClick:d,isPrivateProject:o,isStarterProject:u,isOverProjectKnowledgeLimit:x,isLoading:m,shouldShowOutlineSyncSource:f,handleOutlineClick:g,setIsUploadingDriveSync:j,setIsUploadingMcpSync:y}=e,[w,M]=(0,v.useState)(!1),[S,A]=(0,v.useState)(null),{value:_}=(0,p.fS)("nebula_drift_enabled"),k=(0,X.Uz)({isConnected:!0,hasPromptsOrResources:!0}),C=_?k.filter(e=>e.resources.length>0&&void 0!==e.url):[],D=n||s||C.length>0,{isDriveAuthenticated:U,initDriveAuth:E,handleDriveTrigger:I}=(0,N.cI)({callerIdentifier:"project",handleAuthSuccess:e=>{M(e),e?setTimeout(()=>{A("gdrive")},100):A(null)}}),P=U&&o;return(0,a.jsxs)(c.ms,{align:"end",unstyledTrigger:!0,trigger:(0,a.jsx)(ee,{isStarterProject:u,isOverProjectKnowledgeLimit:x,isLoading:m}),open:w,onOpenChange:M,children:[(0,a.jsx)(c.tJ,{onClick:i,className:"text-left",icon:(0,a.jsx)(r.o3,{}),children:(0,a.jsx)(b.A,{defaultMessage:"Upload from device",id:"vMaZk5Jcnv"})}),(0,a.jsx)(c.tJ,{onClick:d,className:"text-left",icon:(0,a.jsx)(r.XG,{}),children:(0,a.jsx)(b.A,{defaultMessage:"Add text content",id:"G7XW3Mvn8X"})}),D?(0,a.jsx)(c.DG,{}):null,s&&(0,a.jsx)(et,{type:h.v8.GITHUB,isPrivateProject:o,onClick:l}),n&&(0,a.jsx)(es,{projectUuid:t,isPrivateProject:o,setIsUploadingDriveSync:j,isOpen:"gdrive"===S,setIsOpen:e=>A(e?"gdrive":null),closeWholeDropdown:()=>{A(null),M(!1)},showGoogleDriveSubDropdown:P,handleGoogleDriveButtonClick:()=>{!P&&o&&(U?I():E())}}),f&&(0,a.jsx)(et,{type:h.v8.OUTLINE,isPrivateProject:o,onClick:g}),(0,a.jsx)(ea,{mcpServers:C,projectUuid:t,openSubDropdownId:S,setOpenSubDropdownId:A,setIsOpen:M,setIsUploadingMcpSync:y})]})},ee=(0,v.forwardRef)((e,t)=>{let{isStarterProject:s,isOverProjectKnowledgeLimit:n,isLoading:l,...i}=e,d=(0,a.jsx)(o.$,{...i,ref:t,size:"icon_sm",variant:"ghost","data-testid":"project-doc-uploader-dropdown-trigger",disabled:s||n||l,loading:l,className:"-mr-2 !scale-100",tooltip:(0,a.jsx)(b.A,{defaultMessage:"Add files",id:"xrAjmQ72mN"}),children:(0,a.jsx)(r.OM,{size:16})});return s?(0,a.jsx)(k.m,{children:(0,a.jsx)("div",{children:d})}):n?(0,a.jsx)(x.Tooltip,{side:"bottom",tooltipContent:(0,a.jsx)(b.A,{defaultMessage:"Project knowledge at capacity. Remove an existing file in order to add to knowledge",id:"g3hx72ya32"}),children:(0,a.jsx)("div",{children:d})}):d});ee.displayName="ProjectDocUploaderDropdownTrigger";let et=e=>{let{type:t,isPrivateProject:s,isSubTrigger:n=!1,isSubDropdownOpen:l=!1,onClick:i}=e,r=n?c.Wn:c.tJ,o=(0,a.jsxs)(r,{onClick:i,onPointerLeave:e=>{n&&l&&e.preventDefault()},onPointerMove:e=>{n&&l&&e.preventDefault()},disabled:!s,className:"text-left",children:[(0,a.jsxs)("div",{className:"flex font-base items-center gap-2.5 py-0.5",children:[(0,a.jsx)(d.A9,{type:t,size:18}),(0,C.xI)(t)]}),n&&(0,a.jsx)(f.K,{size:18})]});return s?o:(0,a.jsx)(x.Tooltip,{side:"left",tooltipContent:(0,a.jsx)(b.A,{defaultMessage:"Only accessible from private projects",id:"lNrma+LwGe"}),children:(0,a.jsx)("div",{children:o})})},es=e=>{let{projectUuid:t,isPrivateProject:s,setIsUploadingDriveSync:n,isOpen:l,setIsOpen:i,closeWholeDropdown:r,showGoogleDriveSubDropdown:d,handleGoogleDriveButtonClick:o}=e;return d?(0,a.jsxs)(c.MS,{open:l,onOpenChange:i,children:[(0,a.jsx)(et,{type:h.v8.GDRIVE,isPrivateProject:s,isSubTrigger:!0,isSubDropdownOpen:l}),(0,a.jsx)(c.cm,{children:(0,a.jsx)(q,{projectUuid:t,isSubDropdown:!0,setIsUploadingDriveSync:n,isOpen:l,setIsOpen:i,closeWholeDropdown:r,shouldAddSyncUponPaste:!0})})]}):(0,a.jsx)(et,{type:h.v8.GDRIVE,isPrivateProject:s,onClick:o})},ea=e=>{let{mcpServers:t,projectUuid:s,openSubDropdownId:n,setOpenSubDropdownId:l,setIsOpen:i,setIsUploadingMcpSync:r}=e;return 0===t.length?null:(0,a.jsx)(a.Fragment,{children:t.map(e=>{let t="mcp-".concat(e.uuid),d=n===t;return(0,a.jsx)(en,{server:e,projectUuid:s,isOpen:d,setIsOpen:e=>{l(("function"==typeof e?e(d):e)?t:null)},closeWholeDropdown:()=>{l(null),i(!1)},setIsUploadingMcpSync:r},t)})})},en=e=>{let{server:t,projectUuid:s,isOpen:n,setIsOpen:l,closeWholeDropdown:i,setIsUploadingMcpSync:r}=e,d=(0,$.c)(t.name),o=(0,a.jsx)("span",{className:"text-text-300 text-sm truncate max-w-[150px]",title:t.name!==d?t.name:void 0,children:d});return(0,a.jsxs)(c.MS,{open:n,onOpenChange:l,children:[(0,a.jsxs)(c.Wn,{className:"flex w-full items-center justify-between gap-2 px-2 py-1.5 hover:bg-bg-200 rounded cursor-pointer",children:[(0,a.jsxs)("div",{className:"flex items-center gap-2 min-w-0",children:[(0,a.jsx)(D.z,{type:"favicon",src:t.url,size:16,name:d}),o]}),(0,a.jsx)(f.K,{size:16,className:"text-text-500 flex-shrink-0"})]}),(0,a.jsx)(c.cm,{children:n&&(0,a.jsx)(H,{server:t,projectUuid:s,_setIsOpen:l,closeWholeDropdown:i,setIsUploadingMcpSync:r})})]})},el=e=>{let{isOpen:t,onClose:s,title:n,setTitle:l,content:r,setContent:d,onSave:c}=e,x=(0,y.A)(),p=(0,v.useRef)(null);return(0,m.y)({shouldFocus:t,target:p}),(0,a.jsx)(u.aF,{isOpen:t,onClose:s,modalSize:"xl",className:"p-7 pt-6",children:(0,a.jsxs)("form",{onSubmit:e=>{e.preventDefault(),""!==n.trim()&&""!==r.trim()&&c()},children:[(0,a.jsx)("h2",{className:"font-claude-response mb-3 text-xl",children:(0,a.jsx)(b.A,{defaultMessage:"Add text content",id:"G7XW3Mvn8X"})}),(0,a.jsx)(i.ks,{ref:p,placeholder:x.formatMessage({defaultMessage:"Name your content",id:"C7Sx4g/l21"}),className:"mb-2 w-full",size:"lg",label:(0,a.jsx)(b.A,{defaultMessage:"Title",id:"9a9+wwWy4u"}),value:n,onChange:e=>l(e.target.value),required:!0}),(0,a.jsx)(i.fs,{placeholder:x.formatMessage({defaultMessage:"Type or paste in content...",id:"f5RDuqxeT2"}),label:x.formatMessage({defaultMessage:"Content",id:"Jq3FDzj0/T"}),minRows:12,value:r,onChange:e=>d(e.target.value),required:!0,className:"max-h-[50vh] overflow-y-auto"}),(0,a.jsxs)("div",{className:"mt-4 flex justify-end gap-2",children:[(0,a.jsx)(o.$,{variant:"secondary",onClick:e=>{e.preventDefault(),s()},children:(0,a.jsx)(b.A,{defaultMessage:"Cancel",id:"47FYwba+bI"})}),(0,a.jsx)(o.$,{type:"submit",children:(0,a.jsx)(b.A,{defaultMessage:"Add Content",id:"66s1201qd9"})})]})]})})},ei=e=>{let{size:t="default",projectUuid:s,tooltipContent:n}=e,l=(0,_.ED)(s),{maxKbTokens:i}=(0,_.AO)(),r=(0,_.gq)(s),d=(0,_.AV)(),c=(0,_.Pb)(s);if(!l)return null;let u=Math.ceil(l/i*100),m=u>80&&u<100,p=u>=100,h=r?Math.min(100,r/i*100):void 0;return(0,a.jsxs)("div",{className:(0,j.A)("default"!==t&&"flex items-center gap-3"),children:[(0,a.jsxs)("div",{className:(0,j.A)("bg-bg-300 rounded-full p-px border-border-300 border-0.5 relative","small"===t&&"w-24"),children:[(0,a.jsx)("div",{style:{width:"".concat(Math.max(2,Math.min(100,u)),"%")},className:(0,j.A)("h-1.5 rounded-full transition-all",!m&&!p&&"bg-accent-secondary-100",m&&"bg-warning-orange",p&&"bg-danger-200")}),d&&void 0!==h&&l>=(r||0)&&(0,a.jsx)("div",{className:"absolute top-1/2 -translate-y-1/2 w-1.5 h-1.5 bg-text-100 rounded-full mix-blend-normal",style:{left:"".concat(h,"%"),transform:"translate(-50%, -50%)"}})]}),(0,a.jsxs)("div",{className:(0,j.A)("flex gap-2 items-center text-xs","default"===t&&"mt-2"),children:[(0,a.jsx)("div",{className:(0,j.A)("flex-1",u<100&&"text-text-400",u>=100&&"text-danger-000 font-medium"),children:(0,a.jsx)(b.A,{defaultMessage:"{pctUsed}% of project capacity used",id:"JfriU6oVgp",values:{pctUsed:u}})}),!d&&(0,a.jsx)(x.Tooltip,{className:"text-center mt-0.5",side:"left",tooltipContent:null!=n?n:(0,a.jsx)(b.A,{defaultMessage:"Project knowledge is currently limited to Claude’s maximum context window size.",id:"aAeavdIV/P"}),children:(0,a.jsx)("div",{className:"flex items-center",children:(0,a.jsx)(o.$,{size:"unset",variant:"unstyled",href:"https://support.anthropic.com/en/articles/9517075-what-are-projects",target:"_blank",className:"rounded-full text-text-500 hover:text-text-200",children:(0,a.jsx)(g.R,{size:14})})})}),c&&(0,a.jsx)("div",{className:"text-text-400 text-xs flex gap-1",children:(0,a.jsx)(x.Tooltip,{className:"text-center mt-0.5",side:"bottom",tooltipContent:null!=n?n:(0,a.jsx)(b.A,{defaultMessage:"To save space, Claude looks up information as needed.",id:"a/OO1blv/l"}),children:(0,a.jsxs)("div",{className:"flex gap-1 items-center",children:[(0,a.jsx)("div",{className:"w-1.5 h-1.5 bg-text-500 rounded-full"}),(0,a.jsx)(b.A,{defaultMessage:"Retrieving",id:"RmdvWf4BuF"})]})})})]}),u>=100&&(0,a.jsx)("div",{className:"text-text-400 text-xs",children:(0,a.jsx)(b.A,{defaultMessage:"Remove an existing file in order to add to knowledge",id:"mSQjDnX2IA"})})]})}},61987:(e,t,s)=>{s.d(t,{b:()=>T,N:()=>L});var a=s(54568),n=s(7620),l=s(47479),i=s(45054),r=s(23812),d=s(54787),o=s(68067),c=s(2e3),u=s(59880),x=s(39109),m=s(61295),p=s(90215),h=s(32536),f=s(59666),g=s(34385),j=s(93714),v=s(71462);let y=e=>{let{doc:t,canEditKnowledgeBase:s,...i}=e,{mutate:r}=(0,g.gG)(t.project_uuid),d=(0,n.useMemo)(()=>new TextEncoder().encode(t.content).length,[t]),o={created_at:t.created_at,file_name:t.file_name,file_size:d,file_type:"",extracted_content:t.content,origin:v.R.UserUpload};return(0,a.jsx)(l.NM,{...i,file:o,handleRemove:()=>r({docUuid:t.uuid})})},b=e=>{let{file:t,projectUuid:s,canEditKnowledgeBase:n,...i}=e,{mutate:r,isPending:d}=(0,g.KU)(s);return(0,a.jsx)(l.NM,{...i,file:t,handleRemove:()=>{r({file_uuids:[t.file_uuid]})},isLoading:d})};var w=s(65891),M=s(81478),N=s(13910),S=s(89919),A=s(18868),_=s(10369),k=s(22167),C=s(46868);function D(e){let{projectUuid:t,syncSource:s,isActionsHidden:l,canEditKnowledgeBase:r,...d}=e,{mutateAsync:o}=(0,j.bG)(t),{isUpdating:u,handleUpdate:x,isFailing:m}=function(e){let{projectUuid:t,syncSource:s}=e,[a,l]=(0,n.useState)(!1),{addSuccess:r}=(0,i.Y)(),d=(0,_.A)(),{mutate:o}=(0,j.M3)(t,{onSuccess:()=>{r(d.formatMessage({defaultMessage:"Sync started",id:"yyuAtTi0E+"}))}});(0,n.useEffect)(()=>{l(!1)},[s.status]);let c=(0,k.z3)(s)||a,u=(0,k.Dd)(s),x=(0,n.useCallback)(()=>{c||(l(!0),o({sync_source_uuid:s.uuid,sync_source_config:s.config}))},[c,o,s.config,s.uuid]);return{isUpdating:c,isFailing:u,handleUpdate:x}}({projectUuid:t,syncSource:s});return(0,a.jsx)(C.br,{...d,location:"project",projectUuid:t,syncSource:s,handleRemove:()=>o(s.uuid),actions:s.type===c.v8.GITHUB?(0,a.jsx)(U,{handleUpdate:x,isFailing:m,isSyncing:u}):void 0,isSyncing:u||m})}function U(e){let{handleUpdate:t,isFailing:s,isSyncing:n}=e,i=(0,_.A)();return(0,a.jsx)(N.Tooltip,{tooltipContent:n?i.formatMessage({defaultMessage:"Syncing...",id:"S92mvo6R0o"}):s?i.formatMessage({defaultMessage:"Sync failed. Click to retry",id:"zOAqlyzs1U"}):i.formatMessage({defaultMessage:"Sync now",id:"SwsYB/OerA"}),children:(0,a.jsx)(l.G,{className:"!w-[18px] !px-0 shrink-0",onClick:t,children:n?(0,a.jsx)(S.P,{size:12,className:"animate-spin"}):s?(0,a.jsx)(A.N,{size:12}):(0,a.jsx)(S.P,{size:12})})})}var E=s(51461);let I="project_syncs",P="project_docs",O="project_linked_files";function T(e){let{project:t,canEditKnowledgeBase:s=!1,isUploadingDoc:i=!1,isUploadingDriveSync:o=!1,isUploadingOutlineSync:c=!1,isUploadingGithubSync:g=!1,isUploadingMcpSync:j=!1,setIsUploadingDoc:v,setIsUploadingDriveSync:w,setIsUploadingOutlineSync:N,setIsUploadingGithubSync:S,setIsUploadingMcpSync:A,maxItems:_,onViewAll:k,isEditable:C}=e,{githubSyncSources:U,driveSyncSources:T,outlineSyncSources:F,mcpResourcesSyncSources:G,projectDocs:V,linkedFiles:K,isFetchingKnowledge:W,knowledgeCount:Y}=L({projectUuid:t.uuid,maxItems:_}),{isDeleting:B,selectedItems:q,handleSelect:J,selectAllItems:X,isInSelectionMode:$,toggleSelectMode:H,handleDeleteSelected:Z}=R({githubSyncSources:U,driveSyncSources:T,outlineSyncSources:F,mcpResourcesSyncSources:G,projectDocs:V,linkedFiles:K,projectUuid:t.uuid,isEnabled:s});z({clearUploadingState:()=>null==v?void 0:v(!1),numItems:V.length+K.length}),z({clearUploadingState:()=>null==S?void 0:S(!1),numItems:U.length}),z({clearUploadingState:()=>null==w?void 0:w(!1),numItems:T.length}),z({clearUploadingState:()=>null==N?void 0:N(!1),numItems:F.length}),z({clearUploadingState:()=>null==A?void 0:A(!1),numItems:G.length});let Q=new Set(q.map(e=>{let{uuid:t}=e;return t}));if(W)return(0,a.jsx)(d.j,{className:"!rounded-2xl !h-[10rem] !w-full !bg-bg-200",variant:"light"});if(0===Y&&!i&&!o&&!c&&!g&&!j)return(0,a.jsxs)("div",{className:"text-center h-[10rem] bg-bg-200 rounded-2xl flex flex-col gap-3 items-center justify-center text-text-500 font-small",children:[(0,a.jsx)(h.default,{src:"/images/illustrations/project-knowledge-light-mode.svg",alt:"",width:105,height:56,className:"dark:hidden"}),(0,a.jsx)(h.default,{src:"/images/illustrations/project-knowledge-dark-mode.svg",alt:"",width:105,height:56,className:"hidden dark:block"}),(0,a.jsx)("div",{className:"max-w-[14.5rem]",children:(0,a.jsx)(f.A,{defaultMessage:"Add PDFs, documents, or other text to reference in this project.",id:"EC12TWMoUS"})})]});let ee=(0,a.jsx)(x.N,{children:$&&(0,a.jsx)(m.P.div,{initial:{opacity:0,height:0},animate:{opacity:1,height:"auto"},exit:{opacity:0,height:0},children:(0,a.jsx)(M.g,{isLoading:B,numSelected:q.length,totalNumItems:Y,handleSelectAll:X,handleCancel:()=>H(!1),handleDeleteSelected:Z})},"item-management-menu")}),et={size:"stretch",isEditable:C,isInSelectionMode:$};return(0,a.jsxs)("div",{className:"flex flex-col mb-1",children:[(0,a.jsxs)(p.o,{children:[(0,a.jsx)(x.N,{children:s&&(0,a.jsx)(m.P.div,{initial:{opacity:0,height:0},animate:{opacity:1,height:"auto"},className:"mb-3",children:(0,a.jsx)(E.H,{projectUuid:t.uuid})})}),(0,a.jsx)("div",{className:"ml-1 -mr-2.5",children:ee}),(0,a.jsx)("ul",{className:"grid grid-cols-[repeat(auto-fill,minmax(120px,1fr))] gap-3 mt-3",children:(0,a.jsxs)(x.N,{initial:!1,children:[(0,a.jsx)(l.NG,{isShown:o,...et}),T.map(e=>(0,a.jsx)(D,{projectUuid:t.uuid,syncSource:e,canEditKnowledgeBase:s,isActionsHidden:$||!s,...et,isSelected:Q.has(e.uuid),handleSelect:(t,s)=>J({uuid:e.uuid,type:I},t,s)},e.uuid)),(0,a.jsx)(l.NG,{isShown:c,...et},"outline-sync-loading-indicator"),F.map(e=>(0,a.jsx)(D,{projectUuid:t.uuid,syncSource:e,canEditKnowledgeBase:s,isActionsHidden:$||!s,...et,isSelected:Q.has(e.uuid),handleSelect:(t,s)=>J({uuid:e.uuid,type:I},t,s)},e.uuid)),(0,a.jsx)(l.NG,{isShown:g,...et},"github-sync-loading-indicator"),U.map(e=>(0,n.createElement)(D,{...et,key:e.uuid,projectUuid:t.uuid,syncSource:e,canEditKnowledgeBase:s,isActionsHidden:$||!s,isSelected:Q.has(e.uuid),handleSelect:(t,s)=>J({uuid:e.uuid,type:I},t,s)})),(0,a.jsx)(l.NG,{isShown:j,...et},"mcp-sync-loading-indicator"),G.map(e=>(0,n.createElement)(D,{...et,key:e.uuid,projectUuid:t.uuid,syncSource:e,canEditKnowledgeBase:s,isActionsHidden:$||!s,isSelected:Q.has(e.uuid),handleSelect:(t,s)=>J({uuid:e.uuid,type:I},t,s)})),(0,a.jsx)(l.NG,{isShown:i,...et},"doc-upload-loading-indicator"),V.map(e=>(0,n.createElement)(y,{...et,key:e.uuid,doc:e,canEditKnowledgeBase:s,isSelected:Q.has(e.uuid),handleSelect:(t,s)=>J({uuid:e.uuid,type:P},t,s)})),K.map(e=>(0,n.createElement)(b,{...et,key:e.file_uuid,file:e,projectUuid:t.uuid,canEditKnowledgeBase:s,handleSelect:(t,s)=>J({uuid:e.file_uuid,type:O},t,s),isSelected:Q.has(e.file_uuid)}))]})})]}),!!k&&!!_&&Y>_&&(0,a.jsx)("div",{children:(0,a.jsxs)(r.$,{variant:"unstyled",onClick:k,className:"hover:text-text-000 hover:underline !px-0 text-sm",children:[(0,a.jsx)(f.A,{defaultMessage:"View all {count} files",id:"b36mSZ46cW",values:{count:Y}}),(0,a.jsx)(u.Q,{size:16,className:"inline-block pl-1"})]})})]})}let z=e=>{let{clearUploadingState:t,numItems:s}=e,a=(0,n.useRef)(s);(0,n.useEffect)(()=>{s>a.current&&t(),a.current=s},[s,t])},L=e=>{let{projectUuid:t,maxItems:s}=e,{value:a}=(0,o.fS)("nebula_drift_enabled"),{data:n=[],isLoading:l}=(0,g.MO)(t),i=[...n],{data:r=[],isLoading:d}=(0,j.CO)(t),{data:u=[],isLoading:x}=(0,g.uE)(t),m=[...u],p=r.filter(e=>{let{type:t}=e;return t===c.v8.GDRIVE}),h=r.filter(e=>{let{type:t}=e;return t===c.v8.OUTLINE}),f=r.filter(e=>{let{type:t}=e;return t===c.v8.GITHUB}),v=a?r.filter(e=>{let{type:t}=e;return t===c.v8.MCP_RESOURCES}):[];if(s){let e=s;[p,h,f,v,i,m].forEach(t=>{t.splice(e),e=Math.max(0,e-t.length)})}let y=[i,r,m].reduce((e,t)=>{var s;return e+(null!=(s=null==t?void 0:t.length)?s:0)},0);return{driveSyncSources:p,outlineSyncSources:h,githubSyncSources:f,mcpResourcesSyncSources:v,projectDocs:i,linkedFiles:m,isFetchingKnowledge:l||d||x,knowledgeCount:y}},R=e=>{let{githubSyncSources:t,driveSyncSources:s,outlineSyncSources:a,mcpResourcesSyncSources:n,projectDocs:l,linkedFiles:r,projectUuid:d,isEnabled:o}=e,c=s.map(e=>{let{uuid:t}=e;return{type:I,uuid:t}}).concat(t.map(e=>{let{uuid:t}=e;return{type:I,uuid:t}})).concat(a.map(e=>{let{uuid:t}=e;return{type:I,uuid:t}})).concat(n.map(e=>{let{uuid:t}=e;return{type:I,uuid:t}})).concat(l.map(e=>{let{uuid:t}=e;return{type:P,uuid:t}})).concat(r.map(e=>{let{file_uuid:t}=e;return{type:O,uuid:t}})),{selectedItems:u,handleSelect:x,selectAllItems:m,isInSelectionMode:p,toggleSelectMode:h}=(0,w.m)(c,!o),{addError:f}=(0,i.Y)(),{mutateAsync:v,isPending:y}=(0,j.z_)(d),{mutateAsync:b,isPending:M}=(0,g.Aw)(d),{mutateAsync:N,isPending:S}=(0,g.KU)(d),A=async()=>{let e=u.filter(e=>{let{type:t}=e;return t===P}),t=u.filter(e=>{let{type:t}=e;return t===I}),s=u.filter(e=>{let{type:t}=e;return t===O});h(!1);try{await Promise.all([e.length?b({doc_uuids:e.map(e=>{let{uuid:t}=e;return t})}):Promise.resolve(),t.length?v({sync_source_uuids:t.map(e=>{let{uuid:t}=e;return t})}):Promise.resolve(),s.length?N({file_uuids:s.map(e=>{let{uuid:t}=e;return t})}):Promise.resolve()])}catch(e){f("Something went wrong while deleting. Refresh the page and try again",{error:e})}};return{isDeleting:M||y||S,selectedItems:u,handleSelect:x,selectAllItems:m,isInSelectionMode:p,toggleSelectMode:h,handleDeleteSelected:A}}},65891:(e,t,s)=>{s.d(t,{m:()=>n});var a=s(7620);let n=(e,t)=>{let[s,n]=(0,a.useState)(!1),[l,i]=(0,a.useState)([]);return(0,a.useEffect)(()=>{let t=l.filter(t=>e.some(e=>e.uuid===t.uuid&&e.type===t.type));t.length!==l.length&&i(t)},[e]),(0,a.useEffect)(()=>{n(l.length>0)},[l]),{selectedItems:l,handleSelect:(s,a,n)=>{t||(a?((s,a)=>{t||i(t=>{if(!a||0===Object.keys(t).length)return[...t,s];let n=t[Object.keys(t).length-1],l=e.findIndex(e=>{let{uuid:t,type:s}=e;return t===n.uuid&&s===n.type});if(-1===l)return[...t,s];let i=e.findIndex(e=>{let{uuid:t}=e;return t===s.uuid}),r=Math.min(l+1,i),d=Math.max(l-1,i),o=e.slice(r,d+1),c=t.map(e=>{let{uuid:t}=e;return t});return[...t,...o.filter(e=>{let{uuid:t}=e;return -1===c.indexOf(t)})]})})(s,n):(e=>{t||i(t=>t.filter(t=>{let{uuid:s,type:a}=t;return s!==e.uuid||a!==e.type}))})(s))},selectAllItems:()=>{t||(l.length===e.length?i([]):i(e))},isInSelectionMode:!t&&s,toggleSelectMode:e=>{n(e),e||i([])}}}},72178:(e,t,s)=>{s.d(t,{aD:()=>o,aW:()=>m,bF:()=>c,q:()=>x,v9:()=>u});var a=s(54568),n=s(82028),l=s(71700),i=s(63911),r=s(9398),d=s(2e3);let o=function(e,t,s){let n=arguments.length>3&&void 0!==arguments[3]?arguments[3]:"sm";return{id:"web_search",name:e.formatMessage({defaultMessage:"Web search",id:"x0W7xxxEcv"}),icon:(0,a.jsx)(i.qz,{size:"md"===n?16:12,className:"text-text-300"}),type:"builtin",isConnected:t,onClick:s}},c=function(e,t,s){let n=arguments.length>3&&void 0!==arguments[3]?arguments[3]:"sm";return{id:"extended_thinking",name:e.formatMessage({defaultMessage:"Extended thinking",id:"5j4WakKa2u"}),icon:(0,a.jsx)(i.Sw,{size:"md"===n?16:12,className:"text-text-300"}),type:"builtin",isConnected:t,onClick:s}},u=function(e,t,s){let n=arguments.length>3&&void 0!==arguments[3]?arguments[3]:"sm";return{id:"research",name:e.formatMessage({defaultMessage:"Research",id:"JEe7dVso7F"}),icon:(0,a.jsx)(i.is,{size:"md"===n?16:12,className:"text-text-300"}),type:"builtin",isConnected:t,onClick:s}},x=function(e,t,s,n){let l=arguments.length>4&&void 0!==arguments[4]?arguments[4]:"sm";return{id:t,name:d.sb[t],icon:(0,a.jsx)(r.A9,{type:t,size:"md"===l?20:16}),type:"first-party",isConnected:s,onClick:n}},m=function(e,t,s,i){let r=arguments.length>4&&void 0!==arguments[4]?arguments[4]:"sm";return{id:t.uuid,name:t.name,icon:t.url?(0,a.jsx)(l.d,{url:t.url,fallbackSvg:(0,a.jsx)(n.B,{letter:t.name,size:"md"===r?20:16}),size:"md"===r?20:16}):(0,a.jsx)(n.B,{letter:t.name,size:"md"===r?20:16}),type:"mcp",isConnected:s,onClick:i}}},81478:(e,t,s)=>{s.d(t,{g:()=>u});var a=s(54568),n=s(58720),l=s(63911),i=s(23812),r=s(13910),d=s(66365);s(7620);var o=s(59666),c=s(22624);let u=e=>{let{isLoading:t=!1,numSelected:s,totalNumItems:u,handleSelectAll:x,handleCancel:m,handleDeleteSelected:p,handleMoveToProject:h}=e,f=(0,c.K)(),{value:g}=(0,d.useFeatureGate)("move_conversation_to_projects");return(0,a.jsxs)("div",{className:"flex items-center rounded-lg w-full gap-2.5",children:[(0,a.jsx)(r.Tooltip,{tooltipContent:s<u?(0,a.jsx)(o.A,{defaultMessage:"Select all",id:"94Fg25VD0N"}):(0,a.jsx)(o.A,{defaultMessage:"Deselect all",id:"Spd88Hdc8Z"}),side:"bottom",disableHoverableContent:!0,children:(0,a.jsx)("div",{children:(0,a.jsx)(n.Sc,{checked:s>0,variant:s===u?"check":"minus",onChange:x,label:0===s?(0,a.jsx)(o.A,{defaultMessage:"Select all",id:"94Fg25VD0N"}):(0,a.jsx)(o.A,{defaultMessage:"Select all ({numSelected})",id:"DyqTu9FCTX",values:{numSelected:s}}),hideLabel:!0,disabled:0===u})})}),(0,a.jsx)("div",{className:"font-base text-text-400",children:(0,a.jsx)(o.A,{defaultMessage:"<format>{count}</format> selected",id:"N0IAIYom8U",values:{format:e=>(0,a.jsx)("span",{className:"tabular-nums",children:e}),count:s}})}),(0,a.jsxs)("div",{className:"mr-auto flex gap-1",children:[h&&f&&g&&(0,a.jsx)(i.$,{size:"icon",tooltip:s>0&&(0,a.jsx)(o.A,{defaultMessage:"Move {numSelected, plural, one {# chat} other {# chats}} to a project",id:"TNDo7KthuR",values:{numSelected:s}}),variant:"ghost",disabled:0===s,onClick:h,children:(0,a.jsx)(l.Jt,{})}),(0,a.jsx)(i.$,{size:"icon",tooltip:s>0&&(0,a.jsx)(o.A,{defaultMessage:"Delete {numSelected} selected {numSelected, plural, one {item} other {items}}",id:"TmuLafn4Jw",values:{numSelected:s}}),variant:"ghost",disabled:0===s,onClick:p,loading:t,children:(0,a.jsx)(l.E9,{})})]}),(0,a.jsx)(i.$,{tooltip:(0,a.jsx)(o.A,{defaultMessage:"Cancel",id:"47FYwba+bI"}),size:"icon",variant:"ghost",onClick:m,children:(0,a.jsx)(l.X,{})})]})}},92502:(e,t,s)=>{s.d(t,{G:()=>d,p:()=>r});var a=s(54568),n=s(7620),l=s(31312);let i=(0,n.createContext)(void 0);function r(e){let{project:t,children:s}=e,n=(0,l.X)(t);return(0,a.jsx)(i.Provider,{value:n,children:s})}function d(){return(0,n.useContext)(i)}}}]);